---
title: Overview of Libraries in Maya-USD
---

Libraries in the maya-usd repository are collections of reusable code modules that provide specific functionalities. They are organized in a hierarchical structure, with the 'plugin/al/lib' directory serving as the root. Each library is encapsulated within its own namespace, such as 'AL' in 'AL_USDMaya', to prevent naming conflicts. Libraries are registered with their dependencies using the 'TF_REGISTRY_FUNCTION' in 'moduleDeps.cpp', which allows for efficient loading and management of these code modules.

<SwmSnippet path="/plugin/al/lib/AL_USDMaya/Doxyfile" line="53">

---

# Library Structure

The Doxyfile is used to generate documentation for the libraries. It specifies how to parse the files and which header files to include. This helps developers understand how to use the libraries.

```
# documentation generated by doxygen is written. Doxygen will use this
# information to generate all constant output in the proper language.
# The default language is English, other supported languages are:
# Afrikaans, Arabic, Brazilian, Catalan, Chinese, Chinese-Traditional,
# Croatian, Czech, Danish, Dutch, Esperanto, Farsi, Finnish, French, German,
# Greek, Hungarian, Italian, Japanese, Japanese-en (Japanese with English
# messages), Korean, Korean-en, Lithuanian, Norwegian, Macedonian, Persian,
# Polish, Portuguese, Romanian, Russian, Serbian, Serbian-Cyrilic, Slovak,
# Slovene, Spanish, Swedish, Ukrainian, and Vietnamese.

OUTPUT_LANGUAGE        = English

# If the BRIEF_MEMBER_DESC tag is set to YES (the default) Doxygen will
# include brief member descriptions after the members that are listed in
# the file and class documentation (similar to JavaDoc).
# Set to NO to disable this.

BRIEF_MEMBER_DESC      = YES

# If the REPEAT_BRIEF tag is set to YES (the default) Doxygen will prepend
# the brief description of a member or function before the detailed description.
```

---

</SwmSnippet>

<SwmSnippet path="/plugin/al/lib/AL_USDMaya/AL/usdmaya/cmds/ProxyShapeCommands.cpp" line="1277">

---

# Library Usage

This file provides an example of how to use the libraries. It shows how to use the flags provided by the library to perform specific tasks, such as excluding some prims from being read when the stage is opened.

```c++
    If you want to exclude some prims from being read when stage is opened, use the -pmi/-populationMaskInclude flag, e.g.

       -populationMaskInclude "/only/show/this/prim1,/only/show/this/prim2"

   It is possible to import the USD stage with an overloaded session layer _(which can be useful if you wish to import
   the scene with a specific set of variants set)_.  To specify the session layer contents, use the -session flag:

       -session "#usda 1.0"

   It is also possible to prevent all loadable prims from being loaded when importing the USD stage by specifying the unloaded
   flag _(the default is false)_

       -unloaded true   //< don't load any loadable prims
       -unloaded false  //< load all loadable prims

    The command will return a string array containing the names of all instances of the created node. (There will be
    more than one instance if more than one transform was selected or passed into the command.)  By default, the will
    be the shortest-unique names; if -fp/-fullpaths is given, then they will be full path names.

    This command is undoable.
)";
```

---

</SwmSnippet>

<SwmSnippet path="/plugin/al/lib/AL_USDMaya/AL/docpages/docs_events.h" line="13">

---

# Library Documentation

This file provides documentation for the libraries. It explains why certain features are used and provides examples of how to use the API. This is a valuable resource for developers who want to understand and use the libraries.

```c
\subsection MMessage Why not use scriptJob / MMessage?

Maya already has its own event management system, which are exposed via the MMessage <i>(and derived
classes)</i> in the API, and scriptJob within MEL/python. These systems work, but they have a number
of drawbacks when deployed in a medium to large sized studio with multiple shows in flight. As an
example of some of the problems that can arise, consider this scenario:

\code
// A callback that will create a node we will store some shot settings on
global proc onFileNew_createMagicNode()
{
  $node = `createNode "transform"`;
  rename $node "essential_shot_settings";
}
global int $scriptJob1 = `scriptJob -e "NewSceneOpened" "onFileNew_createMagicNode"`;

// A callback that will group all nodes into a set we can ignore at export time
global proc onFileNew_createDefaultSetOfNodes()
{
  // add all transforms into a set to ignore at export
  sets -n "doNotExport" `ls -type transform`;
```

---

</SwmSnippet>

# Library Endpoints

Understanding Library Endpoints

<SwmSnippet path="/plugin/al/lib/AL_USDMaya/AL/docpages/docs_events.h" line="579">

---

## initializePlugin

The `initializePlugin` function is an endpoint in the AL_USDMaya library. It is responsible for initializing the plugin, registering events and callbacks, and setting up the event scheduler. This function is called when the plugin is loaded into Maya.

```c
MStatus initializePlugin(MObject obj)
{
  // init the scheduler - this step is only required if you are not using the usdmaya plugin
  AL::event::EventScheduler::initScheduler(&g_eventSystem);

  // to access the global scheduler
  auto& scheduler = AL::event::EventScheduler::getScheduler();

  // lets register a simple event
  g_mySimpleEvent1 = scheduler.registerEvent("OnParentThingHappened", kUserSpecifiedEventType);

  // make sure the event registered correctly
  if(g_mySimpleEvent1 == 0)
  {
    std::cout << "event failed to register (name is in use!)" << std::endl;
  }

  // Simply as an example, we may wish to register a C callback on the event!
  g_myCallbackId1 = scheduler.registerCallback(
    g_mySimpleEvent1,                 ///< the event Id we wish to have our callback triggered on
    "myToolName_myCallbackFunction1", ///< a unique tag to identify the who owns the callback, and
```

---

</SwmSnippet>

<SwmSnippet path="/plugin/al/lib/AL_USDMaya/AL/docpages/docs_events.h" line="639">

---

## uninitializePlugin

The `uninitializePlugin` function is another endpoint in the AL_USDMaya library. It is responsible for cleaning up when the plugin is unloaded from Maya. This includes deregistering events and callbacks, and shutting down the event scheduler.

```c
MStatus uninitializePlugin(MObject obj)
{
  // unregister the callback
  AL::event::EventScheduler::getScheduler().unregisterCallback(g_myCallbackId2);
  AL::event::EventScheduler::getScheduler().unregisterCallback(g_myCallbackId1);

  // unregister the event
  AL::event::EventScheduler::getScheduler().unregisterEvent(g_mySimpleEvent2);
  AL::event::EventScheduler::getScheduler().unregisterEvent(g_mySimpleEvent1);

  MFnPlugin fn(obj);
  fn.unregisterCommand("parentEventExample");

  return MS::kSuccess;
}
```

---

</SwmSnippet>

&nbsp;

_This is an auto-generated document by Swimm AI ðŸŒŠ and has not yet been verified by a human_

<SwmMeta version="3.0.0" repo-id="Z2l0aHViJTNBJTNBbWF5YS11c2QlM0ElM0FnaWxhZG5hdm90" repo-name="maya-usd"><sup>Powered by [Swimm](/)</sup></SwmMeta>
